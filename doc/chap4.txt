  
  [1X4 [33X[0;0YAll Functions[133X[101X
  
  
  [1X4.1 [33X[0;0YFunctions for computing the distance[133X[101X
  
  
  [1X4.1-1 [33X[0;0YExamples[133X[101X
  
  [33X[0;0YHere  are  a few simple examples illustrating the use of distance functions.
  In  all examples, we use [10XDistRandCSS[110X and [10XDistRandStab[110X with [10Xdebug=2[110X to ensure
  that row orthogonality in the input matrices is verified.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XF:=GF(5);;[127X[104X
    [4X[25Xgap>[125X [27XHx:=One(F)*[[1,-1,0,0 ],[0,0,1,-1]];;[127X[104X
    [4X[25Xgap>[125X [27XHz:=One(F)*[[1, 1,1,1]];;[127X[104X
    [4X[25Xgap>[125X [27XDistRandCSS(Hz,Hx,100,0,2 : field:=F);[127X[104X
    [4X[28X2[128X[104X
  [4X[32X[104X
  
  [33X[0;0YNow,  if  we  set  the  minimum  distance  [10Xmindist[110X  parameter too large, the
  function  terminates  immediately  after  a  codeword  with such a weight is
  found; in such a case the result is returned with the negative sign.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XDistRandCSS(Hz,Hx,100,2,2 : field:=F);[127X[104X
    [4X[28X-2[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThe  function [10XDistRandStab[110X takes only one matrix. This example uses the same
  CSS  code  but  written into a single matrix. Notice how the values from the
  previous example are intercalated with zeros.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XF:=GF(5);;[127X[104X
    [4X[25Xgap>[125X [27XH:=One(F)*[[1,0, -1,0,  0,0,  0,0 ], # original Hx in odd positions[127X[104X
    [4X[25X>[125X [27X           [0,0,  0,0,  1,0, -1,0 ],[127X[104X
    [4X[25X>[125X [27X           [0,1,  0,1,  0,1,  0,1 ]];; # original Hz in even positions[127X[104X
    [4X[25Xgap>[125X [27XDistRandStab(H,100,0,2 : field:=F);[127X[104X
    [4X[28X2[128X[104X
  [4X[32X[104X
  
  [1X4.1-2 DistRandCSS[101X
  
  [33X[1;0Y[29X[2XDistRandCSS[102X( [3XHX[103X, [3XHZ[103X, [3Xnum[103X, [3Xmindist[103X[, [3Xdebug[103X][3X:[103X [3Xfield[103X [3X:=[103X [3XGF(2)[103X, [3Xmaxav[103X [3X:=[103X [3Xfail[103X ) [32X function[133X
  [6XReturns:[106X  [33X[0;10YAn upper bound on the CSS distance [23Xd_Z[123X[133X
  
  [33X[0;0YComputes  an  upper  bound  on  the  distance  [23Xd_Z[123X  of  the  [23Xq[123X-ary code with
  stabilizer  generator  matrices  [23XH_X[123X,  [23XH_Z[123X  whose  rows  are  assumed  to be
  orthogonal  ([13Xorthogonality  is  not  verified[113X).  See  Section  [14X3.1[114X  for  the
  description of the algorithm.[133X
  
  [33X[0;0YDetails of the input parameters[133X
  
  [30X    [33X[0;6Y[10XHX[110X, [10XHZ[110X: the input matrices with elements in the Galois [10Xfield[110X [23XF[123X[133X
  
  [30X    [33X[0;6Y[10Xnum[110X: number of information sets to construct (should be large)[133X
  
  [30X    [33X[0;6Y[10Xmindist[110X  - the algorithm stops when distance equal or below [10Xmindist[110X is
        found  and  returns the result with negative sign. Set [10Xmindist[110X to 0 if
        you want the actual distance.[133X
  
  [30X    [33X[0;6Y[10Xdebug[110X: optional integer argument containing debug bitmap (default: [10X0[110X)[133X
  
        [30X    [33X[0;12Y1 (0s bit set) : print 1st of the vectors found[133X
  
        [30X    [33X[0;12Y2  (1st  bit  set)  : check orthogonality of matrices and of the
              final vector[133X
  
        [30X    [33X[0;12Y4 (2nd bit set) : show occasional progress update[133X
  
        [30X    [33X[0;12Y8  (3rd  bit  set)  : maintain cw count and estimate the success
              probability[133X
  
  [30X    [33X[0;6Y[10Xfield[110X (Options stack): Galois field, default: [23XGF(2)[123X.[133X
  
  [30X    [33X[0;6Y[10Xmaxav[110X  (Options stack): if set, terminate when [23X\langle n\rangle[123X>[10Xmaxav[110X,
        see Section [14X3.1-4[114X. Not set by default.[133X
  
  [1X4.1-3 DistRandStab[101X
  
  [33X[1;0Y[29X[2XDistRandStab[102X( [3XH[103X, [3Xnum[103X, [3Xmindist[103X[, [3Xdebug[103X][3X:[103X [3Xfield[103X [3X:=[103X [3XGF(2)[103X, [3Xmaxav[103X [3X:=[103X [3Xfail[103X ) [32X function[133X
  [6XReturns:[106X  [33X[0;10YAn upper bound on the code distance [23Xd[123X[133X
  
  [33X[0;0YComputes  an  upper  bound on the distance [23Xd[123X of the [23XF[123X-linear stabilizer code
  with  generator matrix [23XH[123X whose rows are assumed to be symplectic-orthogonal,
  see Section [14X3.1-5[114X ([13Xorthogonality is not verified[113X).[133X
  
  [33X[0;0YDetails of the input parameters:[133X
  
  [30X    [33X[0;6Y[10XH[110X:  the  input  matrix  with  elements  in  the Galois [10Xfield[110X [23XF[123X with [23X2n[123X
        columns [23X(a_1,b_1,a_2,b_2,\ldots,a_n,b_n)[123X.[133X
  
  [33X[0;0YThe  remaining  options  are  identical to those in the function [10XDistRandCSS[110X
  [14X4.1-2[114X.[133X
  
  [30X    [33X[0;6Y[10Xnum[110X: number of information sets to construct (should be large)[133X
  
  [30X    [33X[0;6Y[10Xmindist[110X  -  the  algorithm  stops  when distance equal or smaller than
        [10Xmindist[110X is found - set it to 0 if you want the actual distance[133X
  
  [30X    [33X[0;6Y[10Xdebug[110X: optional integer argument containing debug bitmap (default: [10X0[110X)[133X
  
        [30X    [33X[0;12Y1 (0s bit set) : print 1st of the vectors found[133X
  
        [30X    [33X[0;12Y2  (1st  bit  set)  : check orthogonality of matrices and of the
              final vector[133X
  
        [30X    [33X[0;12Y4 (2nd bit set) : show occasional progress update[133X
  
        [30X    [33X[0;12Y8  (3rd  bit  set)  : maintain cw count and estimate the success
              probability[133X
  
  [30X    [33X[0;6Y[10Xfield[110X (Options stack): Galois field, default: [23XGF(2)[123X.[133X
  
  [30X    [33X[0;6Y[10Xmaxav[110X  (Options stack): if set, terminate when [23X\langle n\rangle[123X>[10Xmaxav[110X,
        see Section [14X3.1-4[114X. Not set by default.[133X
  
  
  [1X4.2 [33X[0;0YInput/Output Functions[133X[101X
  
  [1X4.2-1 ReadMTXE[101X
  
  [33X[1;0Y[29X[2XReadMTXE[102X( [3XFilePath[103X[, [3Xpair[103X][3X:[103X [3Xfield[103X [3X:=[103X [3XGF(2)[103X ) [32X function[133X
  [6XReturns:[106X  [33X[0;10Ya list [[10Xfield[110X, [10Xpair[110X, [10XMatrix[110X, [10Xarray_of_comment_strings[110X][133X
  
  [33X[0;0YRead  matrix from an MTX file, an extended version of Matrix Market eXchange
  coordinate  format  supporting  finite Galois fields and two-block matrices [23X
  (A|B)  [123X  with  columns  [23XA=(a_1, a_2, \ldots , a_n)[123X and [23XB=(b_1, b_2, \ldots ,
  b_n)[123X, see Chapter [14X5[114X.[133X
  
  [30X    [33X[0;6Y[10XFilePath[110X name of existing file storing the matrix[133X
  
  [30X    [33X[0;6Y[10Xpair[110X  (optional  argument):  specifies column ordering; must correlate
        with the variable [10Xtype[110X in the file[133X
  
        [30X    [33X[0;12Y[10Xpair=0[110X   for   regular   single-block   matrices   (e.g.,   CSS)
              [10Xtype=integer[110X  (if  [10Xpair[110X  not specified, [10Xpair[110X=0 is set by default
              for [10Xinteger[110X)[133X
  
        [30X    [33X[0;12Y[10Xpair=1[110X  intercalated  columns with [10Xtype=integer[110X [23X (a_1, b_1, a_2,
              b_2,\ldots) [123X[133X
  
        [30X    [33X[0;12Y[10Xpair=2[110X  grouped  columns  with  [10Xtype=integer[110X [23X (a_1, a_2, \ldots,
              a_n\; b_1, b_2,\ldots, b_n) [123X[133X
  
        [30X    [33X[0;12Y[10Xpair=3[110X  this  is  the only option for [10Xtype=complex[110X with elements
              specified as "complex" pairs[133X
  
  [30X    [33X[0;6Y[10Xfield[110X  (Options  stack): Galois field, default: [23XGF(2)[123X. [13XMust[113X match that
        given in the file (if any).[133X
  
  [33X[0;0Y[13XNotice[113X:  with [10Xpair[110X=1 and [10Xpair[110X=2, the number of columns specified in the file
  must be even, twice the block length of the code[133X
  
  [33X[0;0Y1st line of file must read:[133X
  
  [4X[32X  Code  [32X[104X
    [4X %%MatrixMarket matrix coordinate `type` general [104X
  [4X[32X[104X
  
  [33X[0;0Ywith [10Xtype[110X being either [10Xinteger[110X or [10Xcomplex[110X[133X
  
  [33X[0;0Y2nd line (optional) may contain:[133X
  
  [4X[32X  Code  [32X[104X
    [4X % Field: `valid_field_name_in_Gap` [104X
  [4X[32X[104X
  
  [33X[0;0YAny  additional entries in the second line are silently ignored. By default,
  [23XGF(2)[123X  is  assumed;  the  default  can  be  overriden  by the optional [10Xfield[110X
  argument.  If  the  field  is specified both in the file and by the optional
  argument, the corresponding values must match.[133X
  
  [33X[0;0YSee  Chapter  [14X5[114X  for  the  details  of  how  the  elements  of the group are
  represented depending on whether the field is a prime field ([23X q [123X a prime) or
  an extension field with [23X q=p^m [123X, [23Xp[123X prime, and [23Xm>1[123X.[133X
  
  [1X4.2-2 WriteMTXE[101X
  
  [33X[1;0Y[29X[2XWriteMTXE[102X( [3XStrPath[103X, [3Xpair[103X, [3Xmatrix[103X[, [3Xcomment[103X[, [3Xcomment[103X]][3X:[103X [3Xfield[103X [3X:=[103X [3XGF(2)[103X ) [32X function[133X
  [6XReturns:[106X  [33X[0;10Yno output[133X
  
  [33X[0;0YExport  a  [10Xmatrix[110X in Extended MatrixMarket format, with options specified by
  the [10Xpair[110X argument.[133X
  
  [30X    [33X[0;6Y[10XStrPath[110X - name of the file to be created;[133X
  
  [30X    [33X[0;6Y[10Xpair[110X:  parameter to control the format details, must match the [10Xtype[110X of
        the matrix.[133X
  
        [30X    [33X[0;12Y[10Xpair=0[110X for regular matrices (e.g., CSS) with [10Xtype=integer[110X[133X
  
        [30X    [33X[0;12Y[10Xpair=1[110X  for  intercalated columns [23X (a_1, b_1, a_2, b_2, \ldots) [123X
              with [10Xtype=integer[110X[133X
  
        [30X    [33X[0;12Y[10Xpair=2[110X  for  grouped  columns  with  [10Xtype=integer[110X  [13X(this  is not
              supported!)[113X[133X
  
        [30X    [33X[0;12Y[10Xpair=3[110X for columns specified in pairs with [10Xtype=complex[110X[133X
  
  [30X    [33X[0;6YColumns of the input [10Xmatrix[110X must be intercalated unless [10Xpair=0[110X[133X
  
  [30X    [33X[0;6Yoptional [10Xcomment[110X: one or more strings (or a single list of strings) to
        be output after the MTX header line.[133X
  
  [33X[0;0YThe second line specifying the field will be generated automatically only if
  the  GAP Option [10Xfield[110X is present. As an option, the line can also be entered
  explicitly as the first line of the comments, e.g., [10X"% Field: GF(256)"[110X[133X
  
  [33X[0;0YSee  Chapter  [14X5[114X  for  the  details  of  how  the  elements  of the group are
  represented depending on whether the field is a prime field ([23X q [123X a prime) or
  an extension field with [23X q=p^m [123X, [23X m>1 [123X.[133X
  
  
  [1X4.3 [33X[0;0YHelper Functions[133X[101X
  
  
  [1X4.3-1 [33X[0;0YExamples[133X[101X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XQDR_AverageCalc([2,3,4,5]);[127X[104X
    [4X[28X3.5[128X[104X
  [4X[32X[104X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XF:=GF(3);; [127X[104X
    [4X[25Xgap>[125X [27Xx:=Indeterminate(F,"x");; poly:=One(F)*(1-x);;[127X[104X
    [4X[25Xgap>[125X [27Xn:=5;;[127X[104X
    [4X[25Xgap>[125X [27Xmat:=QDR_DoCirc(poly,n,2*n,F);; # make a circulant matrix with 5 rows [127X[104X
    [4X[25Xgap>[125X [27XDisplay(mat);[127X[104X
    [4X[28X 1 2 . . . . . . . .[128X[104X
    [4X[28X . . 1 2 . . . . . .[128X[104X
    [4X[28X . . . . 1 2 . . . .[128X[104X
    [4X[28X . . . . . . 1 2 . .[128X[104X
    [4X[28X . . . . . . . . 1 2[128X[104X
  [4X[32X[104X
  
  [1X4.3-2 QDR_AverageCalc[101X
  
  [33X[1;0Y[29X[2XQDR_AverageCalc[102X( [3Xvector[103X ) [32X function[133X
  
  [33X[0;0YCalculate the average of the components of a [10Xvector[110X containing numbers[133X
  
  [1X4.3-3 QDR_SymplVecWeight[101X
  
  [33X[1;0Y[29X[2XQDR_SymplVecWeight[102X( [3Xvector[103X, [3Xfield[103X ) [32X function[133X
  [6XReturns:[106X  [33X[0;10Ysymplectic weight of a vector[133X
  
  [33X[0;0YCalculate  the  symplectic weight of a [10Xvector[110X with an even number of entries
  from the field [10Xfield[110X. The elements of the pairs are intercalated: [23X(a_1, b_1,
  a_2, b_2,\ldots)[123X.[133X
  
  [33X[0;0Y[13XNote: the parity of vector [10Xlength[110X and the format are not verified!!![113X[133X
  
  [1X4.3-4 QDR_WeightMat[101X
  
  [33X[1;0Y[29X[2XQDR_WeightMat[102X( [3Xmatrix[103X ) [32X function[133X
  
  [33X[0;0Ycount the total number of non-zero entries in a matrix.[133X
  
  [1X4.3-5 QDR_DoProbOut[101X
  
  [33X[1;0Y[29X[2XQDR_DoProbOut[102X( [3Xvector[103X, [3Xn[103X, [3Xnum[103X ) [32X function[133X
  
  [33X[0;0Yaux  function  to print out the relevant probabilities given the list [10Xvector[110X
  of  multiplicities  of the codewords found. Additional parameters are [10Xn[110X, the
  code  length,  and  [10Xnum[110X, the number of repetitions; these are ignored in the
  present  version  of  the  program.  See  [14X3.3[114X  for  the  importance of these
  parameters.[133X
  
  [1X4.3-6 QDR_MakeH[101X
  
  [33X[1;0Y[29X[2XQDR_MakeH[102X( [3Xmatrix[103X, [3Xfield[103X ) [32X function[133X
  [6XReturns:[106X  [33X[0;10Y[10XH[110X (the check matrix constructed)[133X
  
  [33X[0;0YGiven  a  two-block  [10Xmatrix[110X  with intercalated columns [23X (a_1, b_1, a_2, b_2,
  \ldots)  [123X,  calculate  the corresponding check matrix [10XH[110X with columns [23X (-b_1,
  a_1, -b_2, a_2, \ldots) [123X.[133X
  
  [33X[0;0YThe parity of the number of columns is verified.[133X
  
  [1X4.3-7 QDR_DoCirc[101X
  
  [33X[1;0Y[29X[2XQDR_DoCirc[102X( [3Xpoly[103X, [3Xm[103X, [3Xn[103X, [3Xfield[103X ) [32X function[133X
  [6XReturns:[106X  [33X[0;10Y[10Xm[110X   by  [10X2*n[110X  circulant  matrix  constructed  from  the  polynomial
            coefficients[133X
  
  [33X[0;0YGiven  the polynomial [10Xpoly[110X [23Xa_0+b_0 x+a_1x^2+b_1x^3 +\ldots[123X with coefficients
  from  the  field  [10XF[110X,  constructs  the corresponding [10Xm[110X by 2[10Xn[110X double circulant
  matrix  obtained  by [10Xm[110X repeated cyclic shifts of the coefficients' vector by
  [23Xs=2[123X positions at a time.[133X
  
